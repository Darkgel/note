# 第七章 事务

数据库系统引入事务的主要目的： 事务会把数据库从一种一致状态转换为另一种一致状态。

锁 -> 事务的隔离性

事务的分类：

- 扁平事务（Flat Transactions）：最常见的事务。所有的操作都处于同一层次，其由BEGIN开始，由COMMIT或ROLLBACK结束，其间的操作都是原子的，要么都执行，要么都回滚。
- 带有保存点的扁平事务（Flat Transactions with Savepoints）：除了支持扁平事务支持的操作外，允许在事务执行过程中回滚到同一事务中较早的一个状态
- 链事务（Chained Transactions）：可视为保存点模式的一种变种，带有保存点的扁平事务能回滚到任意正确的保存点，而链事务的回滚仅限于当前事务，即只能恢复到最近一个的保存点。对于锁的处理，两者也不相同。链事务在执行commit后立即释放了当前事务所持有的锁，而带有保存点的扁平事务不影响迄今为止所持有的锁。
- 嵌套事务（Nested Transactions）: 树形结构
- 分布式事务（Distributed Transactions）： 通常是一个在分布式环境下运行的扁平事务，因此需要根据数据所在位置访问网络中的不同节点

## 事务的实现

事务的隔离性实现 ： 锁
事务的原子性，持久性实现：redo log
事务的一致性实现：undo log